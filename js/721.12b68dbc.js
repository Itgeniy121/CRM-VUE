"use strict";(self["webpackChunkcrm_system"]=self["webpackChunkcrm_system"]||[]).push([[721],{2721:function(e,t,r){r.r(t),r.d(t,{default:function(){return h}});var n=r(3396),i=r(7139);const s={class:"page-title"},o=(0,n._)("h3",null,"Планирование",-1),c={key:1,class:"center"},l={key:2},a={class:"progress"};function u(e,t,r,u,d,g){const p=(0,n.up)("Loader"),m=(0,n.up)("router-link"),w=(0,n.Q2)("tooltip");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n._)("div",s,[o,(0,n._)("h4",null,(0,i.zw)(g.getCurrency(e.info.bill)),1)]),e.loading?((0,n.wg)(),(0,n.j4)(p,{key:0})):e.categories.length?((0,n.wg)(),(0,n.iD)("section",l,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.categories,(e=>((0,n.wg)(),(0,n.iD)("div",{key:e.id},[(0,n._)("p",null,[(0,n._)("strong",null,(0,i.zw)(e.name),1),(0,n.Uk)(" "+(0,i.zw)(g.getCurrency(e.spend))+" из "+(0,i.zw)(g.getCurrency(e.limit)),1)]),(0,n.wy)(((0,n.wg)(),(0,n.iD)("div",a,[(0,n._)("div",{class:(0,i.C_)(["determinate",[e.color]]),style:(0,i.j5)({width:e.progressPercent+"%"})},null,6)])),[[w,e.tp]])])))),128))])):((0,n.wg)(),(0,n.iD)("p",c,[(0,n.Uk)("Категорий пока что нет. Вы можете добавить их "),(0,n.Wm)(m,{to:"/categories"},{default:(0,n.w5)((()=>[(0,n.Uk)("тут")])),_:1})]))])}var d=r(65),g=r(4870),p=r(6007),m={name:"planning",setup(){const e=(0,g.qj)({title:"Planning",description:"aboba"});(0,p.u)({title:(0,n.Fl)((()=>e.title)),meta:[{name:"description",content:(0,n.Fl)((()=>e.description))}]})},data:()=>({loading:!0,categories:[]}),computed:{...(0,d.Se)(["info"])},async mounted(){const e=await this.$store.dispatch("fetchRecords"),t=await this.$store.dispatch("fetchCategories");this.categories=t.map((t=>{const r=e.filter((e=>e.categoryId===t.id)).filter((e=>"outcome"==e.type)).reduce(((e,t)=>e+ +t.amount),0),n=100*r/t.limit,i=n>100?100:n,s=n<60?"green":n<100?"yellow":"red",o=t.limit-r,c=`${o<0?"Превышение на":"Осталось"} ${this.getCurrency(Math.abs(o))}`;return{...t,progressPercent:i,color:s,spend:r,tp:c}})),this.loading=!1},methods:{getCurrency(e){return new Intl.NumberFormat("ru",{style:"currency",currency:"RUB"}).format(e)}}},w=r(89);const y=(0,w.Z)(m,[["render",u]]);var h=y}}]);
//# sourceMappingURL=721.12b68dbc.js.map