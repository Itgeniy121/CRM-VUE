{"version":3,"file":"js/721.83002922.js","mappings":"iMAEOA,MAAM,c,GACTC,EAAAA,EAAAA,GAAqB,UAAjB,gBAAY,G,SAMhBD,MAAQ,U,aAUDA,MAAM,Y,qHAlBbE,EAAAA,EAAAA,IA0BE,aAzBJD,EAAAA,EAAAA,GAGM,MAHNE,EAGM,CAFJC,GACAH,EAAAA,EAAAA,GAAqC,WAAAI,EAAAA,EAAAA,IAA9BC,EAAAC,YAAYC,EAAAC,KAAKC,OAAI,KAGhBF,EAAAG,UAAO,WAArBC,EAAAA,EAAAA,IAAwBC,EAAA,CAAAC,IAAA,KAGZN,EAAAO,WAAWC,S,WAGvBd,EAAAA,EAAAA,IAaU,UAAAe,EAAA,gBAZRf,EAAAA,EAAAA,IAWMgB,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAXcX,EAAAO,YAAPK,K,WAAblB,EAAAA,EAAAA,IAWM,OAX2BY,IAAKM,EAAIC,I,EACxCpB,EAAAA,EAAAA,GAGI,WAFFA,EAAAA,EAAAA,GAA+B,eAAAI,EAAAA,EAAAA,IAApBe,EAAIE,MAAI,YAAY,KAC/BjB,EAAAA,EAAAA,IAAGC,EAAAC,YAAYa,EAAIG,QAAS,QAAIlB,EAAAA,EAAAA,IAAGC,EAAAC,YAAYa,EAAII,QAAK,2BAE1DtB,EAAAA,EAAAA,IAKM,MALNuB,EAKM,EAJJxB,EAAAA,EAAAA,GAGO,OAFHD,OAAK0B,EAAAA,EAAAA,IAAA,CAAC,cAAa,CAAUN,EAAIO,SAChCC,OAAKC,EAAAA,EAAAA,IAAA,CAAAC,MAAUV,EAAIW,gBAAkB,O,eAHXX,EAAIY,W,WATZ,WAD9B9B,EAAAA,EAAAA,IAEmG,IAFnG+B,EAEmG,UAAjG,mDAA8CC,EAAAA,EAAAA,IAA+CC,EAAA,CAAlCC,GAAG,eAAa,C,kBAAC,IAAG,UAAH,U,2CAsB/E,GACEd,KAAM,WACNe,QACE,MAAMC,GAAWC,EAAAA,EAAAA,IAAS,CACxBC,MAAO,WACPC,YAAa,WAEfC,EAAAA,EAAAA,GAAQ,CACNF,OAAOG,EAAAA,EAAAA,KAAS,IAAML,EAASE,QAC/BI,KAAM,CACJ,CACEtB,KAAO,cACPuB,SAASF,EAAAA,EAAAA,KAAS,IAAML,EAASG,iBAKzC,EACAK,KAAMA,KAAA,CACJnC,SAAS,EACTI,WAAY,KAEd4B,SAAU,KACLI,EAAAA,EAAAA,IAAW,CAAC,UAEjBC,gBACE,MAAMC,QAAgBC,KAAKC,OAAOC,SAAS,gBACrCrC,QAAmBmC,KAAKC,OAAOC,SAAS,mBAC9CF,KAAKnC,WAAaA,EAAWsC,KAAIjC,IAC/B,MAAMG,EAAQ0B,EAAQK,QAAOC,GAAKA,EAAEC,aAAepC,EAAIC,KACtDiC,QAAOC,GAAe,WAAVA,EAAEE,OACdC,QAAO,CAACC,EAAKC,IACLD,IAAQC,EAAOC,QACtB,GACIC,EAAU,IAAMvC,EAAQH,EAAII,MAC5BO,EAAkB+B,EAAU,IAAM,IAAMA,EACxCnC,EAAQmC,EAAU,GACtB,QACDA,EAAU,IACT,SACD,MAEKC,EAAU3C,EAAII,MAAQD,EACtBS,EAAM,GAAE+B,EAAU,EAAI,gBAAiB,cAAcb,KAAK3C,YAAYyD,KAAKC,IAAIF,MAErF,MAAO,IACF3C,EACHW,kBACAJ,QACAJ,QACAS,KAED,IAGHkB,KAAKvC,SAAU,CACjB,EACAuD,QAAS,CACR3D,YAAY4D,GACX,OAAO,IAAIC,KAAKC,aAAa,KAAM,CAACzC,MAAO,WAAY0C,SAAU,QAAQC,OAAOJ,EACjF,I,QCxFH,MAAMK,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://crm-system/./src/views/PlanningPage.vue","webpack://crm-system/./src/views/PlanningPage.vue?bfe7"],"sourcesContent":["<template>\r\n    <div>\r\n  <div class=\"page-title\">\r\n    <h3>Планирование</h3>\r\n    <h4>{{ getCurrency(info.bill) }}</h4>\r\n  </div>\r\n\r\n  <Loader v-if=\"loading\"/>\r\n\r\n <p class = 'center'\r\n  v-else-if=\"!categories.length\"\r\n  >Категорий пока что нет. Вы можете добавить их <router-link to=\"/categories\">тут</router-link></p>\r\n\r\n  <section v-else>\r\n    <div v-for=\" cat of categories\" :key=\"cat.id\">\r\n      <p>\r\n        <strong>{{ cat.name }}</strong>\r\n        {{ getCurrency(cat.spend) }} из {{ getCurrency(cat.limit) }}\r\n      </p>\r\n      <div class=\"progress\" v-tooltip=\"cat.tp\">\r\n        <div\r\n            class=\"determinate\" :class=\"[cat.color]\"\r\n            :style=\"{width: cat.progressPercent + '%'}\"\r\n        ></div>\r\n      </div> \r\n    </div>\r\n  </section>\r\n</div>\r\n</template>\r\n<script>\r\nimport { mapGetters } from 'vuex'\r\nimport { computed, reactive } from 'vue';\r\nimport {useHead} from \"@vueuse/head\"\r\nexport default {\r\n  name: 'planning',\r\n  setup () {\r\n    const siteData = reactive({\r\n      title: 'Planning',\r\n      description: \"aboba\"\r\n    })\r\n    useHead({\r\n      title: computed(() => siteData.title),\r\n      meta: [\r\n        {\r\n          name: `description`,\r\n          content: computed(() => siteData.description)\r\n        },\r\n      ],\r\n    })\r\n   \r\n  },\r\n  data: () => ({\r\n    loading: true,\r\n    categories: [],\r\n  }),\r\n  computed: {\r\n    ...mapGetters(['info'])\r\n  },\r\n  async mounted() {\r\n    const records = await this.$store.dispatch('fetchRecords')\r\n    const categories = await this.$store.dispatch('fetchCategories')\r\n    this.categories = categories.map(cat => {\r\n      const spend = records.filter(r => r.categoryId === cat.id)\r\n      .filter(r => r.type == 'outcome')\r\n      .reduce((all, record) =>{\r\n        return all += +record.amount\r\n      },0 )\r\n      const percent = 100 * spend / cat.limit\r\n      const progressPercent = percent > 100 ? 100 : percent\r\n      const color = percent < 60 \r\n      ? 'green'\r\n      :percent < 100\r\n      ? 'yellow'\r\n      :'red'\r\n\r\n      const tpValue = cat.limit - spend\r\n      const tp = `${tpValue < 0 ? 'Превышение на': 'Осталось'} ${this.getCurrency(Math.abs(tpValue))}`\r\n\r\n      return {\r\n        ...cat,\r\n        progressPercent,\r\n        color,\r\n        spend,\r\n        tp,\r\n\r\n      }\r\n    })\r\n\r\n    this.loading = false\r\n  },\r\n  methods: {\r\n   getCurrency(val){\r\n    return new Intl.NumberFormat(\"ru\", {style: \"currency\", currency: \"RUB\"}).format(val);\r\n   }\r\n  }\r\n\r\n}\r\n</script>","import { render } from \"./PlanningPage.vue?vue&type=template&id=62ccf202\"\nimport script from \"./PlanningPage.vue?vue&type=script&lang=js\"\nexport * from \"./PlanningPage.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"D:\\\\crm-system\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementVNode","_createElementBlock","_hoisted_1","_hoisted_2","_toDisplayString","$options","getCurrency","_ctx","info","bill","loading","_createBlock","_component_Loader","key","categories","length","_hoisted_4","_Fragment","_renderList","cat","id","name","spend","limit","_hoisted_5","_normalizeClass","color","style","_normalizeStyle","width","progressPercent","tp","_hoisted_3","_createVNode","_component_router_link","to","setup","siteData","reactive","title","description","useHead","computed","meta","content","data","mapGetters","async","records","this","$store","dispatch","map","filter","r","categoryId","type","reduce","all","record","amount","percent","tpValue","Math","abs","methods","val","Intl","NumberFormat","currency","format","__exports__","render"],"sourceRoot":""}